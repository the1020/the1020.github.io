---
title: ğŸ„ğŸ»â€â™€ï¸ [ìë°”ìŠ¤í¬ë¦½íŠ¸] ì´ì¤‘ ìš°ì„ ìˆœìœ„ í
author: ì˜ˆì€
date: 2022-10-18 19:17:00 +0900
categories: [ì½”ë”©í…ŒìŠ¤íŠ¸]
tags: [ì½”í…Œ, ë°±ì¤€]
subtitle:
  [
    ì´ì¤‘ ìš°ì„ ìˆœìœ„ í(dual priority queue)ëŠ” ì „í˜•ì ì¸ ìš°ì„ ìˆœìœ„ íì²˜ëŸ¼ ë°ì´í„°ë¥¼ ì‚½ì…,
    ì‚­ì œí•  ìˆ˜ ìˆëŠ” ìë£Œ êµ¬ì¡°ì´ë‹¤. ì „í˜•ì ì¸ íì™€ì˜ ì°¨ì´ì ì€ ë°ì´í„°ë¥¼ ì‚­ì œí•  ë•Œ ì—°ì‚°(operation) ëª…ë ¹ì— ë”°ë¼ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ë°ì´í„° ë˜ëŠ” ê°€ì¥ ë‚®ì€ ë°ì´í„° ì¤‘ í•˜ë‚˜ë¥¼ ì‚­ì œí•˜ëŠ” ì ì´ë‹¤.,
  ]
---

## ğŸ“„ ë¬¸ì œ

[ê³¨ë“œ IV ì´ì¤‘ ìš°ì„ ìˆœìœ„ í](https://www.acmicpc.net/problem/7662)

### êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²ƒì€

ëª…ë ì–´ì— ë”°ë¼ ìµœëŒ“ê°’ì„ ì‚­ì œí•˜ê±°ë‚˜ ìµœì†Ÿê°’ì„ ì‚­ì œí•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ ìµœëŒ€í™ê³¼ ìµœì†Œí™ì„ ê°ê° êµ¬ì„±í•œë‹¤. ì–´ëŠ í•œ ìª½ì˜ í™ì—ì„œ ìµœëŒ“(ìµœì†Ÿ)ê°’ì´ ì œê±°ë˜ë©´ ë‚˜ë¨¸ì§€ í™ì—ì„œë„ ì œê±°ë˜ì–´ì•¼ í•˜ëŠ” ê°’ì´ë‹¤. ì´ë¥¼ ìœ„í•´ ì‚½ì…í•œ ê°’ì˜ ì‚­ì œ ì—¬ë¶€ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.

ì¤‘ì•™ì— ì‚½ì…ëœ ê°’ì˜ ì œê±° ì—¬ë¶€ë¥¼ ê´€ë¦¬í•˜ëŠ” ì €ì¥ì†Œë¥¼ ë‘ê³  ìˆê³  ê°ê°ì˜ í™ì—ì„œ ì œê±°ëœ ê°’ì´ ìˆìœ¼ë©´ ë‚˜ _ì´ ê°’ ì œê±°í–ˆì–´!_ í•˜ê³  ì•Œë ¤ì£¼ë©´ ê·¸ ì €ì¥ì†ŒëŠ” ì œê±°ëœ ê°’ì´ë¼ëŠ” í‘œì‹œë¡œ ê°±ì‹ í•œë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.

ì‚½ì… ì‹œì—ëŠ” countë¥¼ ì¦ê°€ì‹œí‚¤ê³  ì œê±°ë˜ëŠ” ì‹œì ì— countë¥¼ ê°ì†Œì‹œí‚¨ë‹¤. ëª…ë ¹ì„ ë‹¤ ìˆ˜í–‰í•œ ë’¤ì— ì´ ì €ì¥ì†Œì— ë‹´ê¸´ ê°’ì„ í™œìš©í•´ì„œ countê°€ 0ë³´ë‹¤ í° ê²½ìš°ëŠ” ì•„ì§ í™ì— ë‚¨ì•„ìˆëŠ” ê°’ì´ ë˜ê³ , ê·¸ ì¤‘ì— ê°€ì¥ ì•ì— ìˆëŠ” ê°’ì´ ìµœëŒ“(ìµœì†Ÿ)ê°’ì´ ëœë‹¤.

#### íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì€ ê°’ì„ í™œìš©í•´ì„œ ìµœëŒ€ í™ê³¼ ìµœì†Œ í™ì„ ê°ê° ìƒì„±í•œë‹¤.

ìš°ì„ ìˆœìœ„ íì˜ ê¸°ëŠ¥ì„ ë‹´ì€ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ê°’ì„ ì‚½ì…í•˜ê±°ë‚˜ ì œê±°í•˜ë©° ë°œìƒí•˜ëŠ” **ì •ë ¬ í•¨ìˆ˜ë§Œ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬**í•œë‹¤.

```javascript
class PriorityQueue {
  constructor(compare) {
    this.heap = [null];
    this.compare = compare;
  }
  /* ... */
}

/* ... */

const maxHeap = new PriorityQueue((a, b) => a > b);
const minHeap = new PriorityQueue((a, b) => a < b);

/* ... */
```

#### ìµœëŒ€ê°’ ë˜ëŠ” ìµœì†Œê°’ì´ íì—ì„œ ì œê±°ë˜ë©´ ì œê±°ë˜ì—ˆìŒì„ ì €ì¥í•  ê°ì²´ê°€ í•„ìš”í•˜ë‹¤.

ìµœëŒ€ê°’ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°(`D 1`)ì€ ìµœëŒ€í™ì—ì„œë§Œ ê°’ì´ ì‚­ì œë˜ê³ , ìµœì†Œê°’ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°(`D -1`) ì—­ì‹œ ìµœì†Œí™ì—ì„œë§Œ ê°’ì´ ì‚­ì œëœë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìƒëŒ€í™ì—ê²Œ ì œê±°ëœ ê°’ì„ ì•Œë ¤ì£¼ê¸° ìœ„í•´ ì œê±°ë˜ì—ˆìŒì„ ë‹´ê³  ìˆì„ ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤.

ê°’ì„ ì‚½ì…í•˜ëŠ” ì—°ì‚°(`I ì •ìˆ˜N`)ì„ ìˆ˜í–‰í•  ë•Œ í•´ë‹¹ ì •ìˆ˜ê°’ì´ ì‚½ì…ë˜ì—ˆìŒì„ ì•„ë˜ì²˜ëŸ¼ ì €ì¥í•´ë‘”ë‹¤.

```javascript
const valid = {};

if (command === "I") {
  maxHeap.push(+num);
  minHeap.push(+num);

  // ğŸ‘‡ ì‚½ì…ëœ ê°’ì˜ countë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤. íŠ¹ì • ì •ìˆ˜ê°€ ì‚½ì…ë˜ë©´ { num : 1 } ì´ëŸ° ì‹ìœ¼ë¡œ ì €ì¥ëœë‹¤.
  valid[+num] = (valid[+num] || 0) + 1;
}
```

ê·¸ë¦¬ê³  ì‚­ì œ ì—°ì‚°ì´ ë°œìƒí•œ ê²½ìš° ì´ countë¥¼ ê°ì†Œì‹œí‚¤ë©´ ëœë‹¤.

ì¦‰ `I 100` ì—°ì‚°ìœ¼ë¡œ ìµœëŒ€/ìµœì†Œí™ì— 1ì´ë¼ëŠ” ê°’ì´ ì‚½ì…ë˜ë©´ `{ 100 : 1 }`ì´ ë  ê²ƒì´ê³ , D ì—°ì‚°ìœ¼ë¡œ ì–´ëŠ í™ì—ì„œë“  100ì´ë¼ëŠ” ê°’ì´ ì œê±°ê°€ ëœë‹¤ë©´ `{ 100 : 0 }`ì´ ëœë‹¤.

ê·¸ëŸ¬ë¯€ë¡œ ì œê±°í•˜ë ¤ëŠ” ê°’ì˜ countë¥¼ í™•ì¸í–ˆëŠ”ë° 0ì´ë©´ ìƒëŒ€ í™ì—ì„œ ì´ë¯¸ ì œê±°í–ˆë‹¤ëŠ” ì˜ë¯¸ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ë³¸ì¸ì˜ ë¦¬ìŠ¤íŠ¸ì—ì„œë„ ê·¸ ê°’ì„ ì œê±°í•œ í›„ì— ì–‘ìª½ì—ì„œ ì œê±°ë˜ì§€ ì•Šì€ ê°’ì„ ì°¾ì„ ë•Œê¹Œì§€ ê³„ì† dequeue ì‘ì—…ì„ í•´ì¤˜ì•¼ í•œë‹¤.

```javascript
while (!heap.empty()) {
  const popedItem = heap.pop();

  // ğŸ‘‡ 0ë³´ë‹¤ í°ë‹¤ëŠ” ê²ƒì€ ìµœëŒ€/ìµœì†Œí™ì— ì•„ì§ ë‚¨ì•„ìˆëŠ” ê°’ì´ë‹¤.
  if (valid[popedItem] > 0) {
    valid[popedItem]--;
    break;
  }
}
```

ëª…ë ¹ì–´ë¥¼ ëª¨ë‘ ìˆ˜í–‰í•œ ë’¤ì— ìµœëŒ€/ìµœì†Œí™ì— ë‚¨ì€ ê°’ê³¼ ê·¸ ê°’ì˜ ì‚­ì œ ì—¬ë¶€ë¥¼ í™•ì¸í•´ì„œ ì‚­ì œë˜ì§€ ì•Šì•˜ê³  í™ì—ì„œ ê°€ì¥ ì•ì— ìˆëŠ” ê°’ì„ ì¶œë ¥í•˜ë©´ ëœë‹¤.

```javascript
// ğŸ‘‡ í™ì˜ ê°€ì¥ ì²« ë²ˆì§¸ ê°’ì˜ ì œê±° ì—¬ë¶€ë¥¼ í™•ì¸ í›„ì— ì œê±°ë˜ì§€ ì•Šì€ ê°’ì„ ì°¾ì„ ë•Œê¹Œì§€ dequeue ì‘ì—…ì„ ë°˜ë³µí•œë‹¤.
while (!heap.empty() && valid[heap.top()] === 0) {
  heap.pop();
}

// ğŸ‘‡ í™ì´ ë‘˜ ë‹¤ ë¹„ì–´ìˆìœ¼ë©´ EMPTYë¥¼ ì¶œë ¥í•œë‹¤.
if (maxHeap.empty() && minHeap.empty()) {
  result.push("EMPTY");
} else {
  // ğŸ‘‡ top()ìœ¼ë¡œ ê° í™ì—ì„œ ê°€ì¥ ì²« ë²ˆì§¸ì— ìˆëŠ” ê°’ì„ ì¶œë ¥í•œë‹¤.
  result.push(`${maxHeap.top()} ${minHeap.top()}`);
}
```

## ğŸ¹ ì½”ë“œ

```javascript
const readline = require("readline");
const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

class PriorityQueue {
  constructor(compare) {
    this.heap = [null];
    this.compare = compare;
  }

  swap(a, b) {
    [this.heap[a], this.heap[b]] = [this.heap[b], this.heap[a]];
  }

  empty() {
    return this.heap.length === 1;
  }

  top() {
    return this.heap[1];
  }

  push(item) {
    this.heap.push(item);
    this.heapifyUp();
  }

  heapifyUp() {
    let currentIndex = this.heap.length - 1;
    let parentIndex = Math.floor(currentIndex / 2);

    while (
      currentIndex > 1 &&
      this.compare(this.heap[currentIndex], this.heap[parentIndex])
    ) {
      this.swap(currentIndex, parentIndex);

      currentIndex = parentIndex;
      parentIndex = Math.floor(currentIndex / 2);
    }
  }

  pop() {
    if (this.heap.length === 1) return;
    if (this.heap.length === 2) return this.heap.pop();
    const result = this.heap[1];
    this.heap[1] = this.heap.pop();

    this.heapifyDown();
    return result;
  }

  heapifyDown() {
    let currentIndex = 1;
    let leftChildIndex = currentIndex * 2;
    let rightChildIndex = currentIndex * 2 + 1;

    if (!this.heap[leftChildIndex]) return;

    while (
      currentIndex < this.heap.length &&
      (this.compare(this.heap[leftChildIndex], this.heap[currentIndex]) ||
        this.compare(this.heap[rightChildIndex], this.heap[currentIndex]))
    ) {
      let compareIndex;

      if (rightChildIndex > this.heap.length - 1) {
        compareIndex = leftChildIndex;
      } else {
        compareIndex = this.compare(
          this.heap[leftChildIndex],
          this.heap[rightChildIndex]
        )
          ? leftChildIndex
          : rightChildIndex;
      }

      this.swap(currentIndex, compareIndex);

      currentIndex = compareIndex;
      leftChildIndex = currentIndex * 2;
      rightChildIndex = currentIndex * 2 + 1;
    }
  }
}

let maxHeap = new PriorityQueue((a, b) => a > b);
let minHeap = new PriorityQueue((a, b) => a < b);
let valid = {};
const result = [];
let t = null,
  k = 0;

const enqueue = (value) => {
  // ğŸ‘‡ ìµœëŒ€/ìµœì†Œí™ì— ê°’ì„ ì‚½ì…í•˜ê³  ê°’ì˜ ì‚­ì œ ì—¬ë¶€ë¥¼ ê´€ë¦¬í•˜ëŠ” ê°ì²´(valid)ì— ì‚½ì…ë˜ì—ˆìŒ(count ì¦ê°€)ìœ¼ë¡œ ê°±ì‹ í•œë‹¤.
  maxHeap.push(value);
  minHeap.push(value);

  valid[value] = (valid[value] || 0) + 1;
};

const dequeue = (heap) => {
  // ğŸ‘‡ ì œê±°í•˜ë ¤ë˜ ê°’ì´ ë‹¤ë¥¸ í™ì—ì„œ ì´ë¯¸ ì œê±°ëœ ê°’ì´ë©´ ë³¸ì¸ í™ì—ì„œë„ ì œê±°í•œ í›„ì— ì•„ì§ ì–‘ìª½ í™ì— ë‚¨ì•„ìˆëŠ” ê°’ì„ ì°¾ì•„ì„œ ì œê±°í•œë‹¤.
  while (!heap.empty()) {
    const popedItem = heap.pop();
    if (valid[popedItem] > 0) {
      valid[popedItem]--;
      break;
    }
  }
};

const removeDummyDataInHeap = (heap) => {
  // ğŸ‘‡ í˜„ì¬ í™ì˜ ì²« ë²ˆì§¸ ê°’ì´ ì œê±°ëœ ê°’ì¸ì§€ í™•ì¸í•˜ê³  ìœ íš¨í•œ ê°’ì´ ë‚˜ì˜¬ ë•Œê¹Œì§€ í•„ìš”ì—†ëŠ” ê°’ì€ ì œê±°í•œë‹¤.
  while (!heap.empty() && valid[heap.top()] === 0) {
    heap.pop();
  }
};

rl.on("line", (line) => {
  if (!t) {
    t = +line;
    return;
  }
  if (k === 0) {
    k = +line;
    maxHeap = new PriorityQueue((a, b) => a > b);
    minHeap = new PriorityQueue((a, b) => a < b);
    valid = {};
    return;
  }

  const [command, num] = line.split(" ");

  if (command === "I") {
    enqueue(+num);
  } else if (+num === 1) {
    dequeue(maxHeap);
  } else if (+num === -1) {
    dequeue(minHeap);
  }

  if (--k === 0) {
    removeDummyDataInHeap(maxHeap);
    removeDummyDataInHeap(minHeap);

    if (maxHeap.empty() && minHeap.empty()) {
      result.push("EMPTY");
    } else {
      result.push(`${maxHeap.top()} ${minHeap.top()}`);
    }
  }
}).on("close", () => {
  console.log(result.join("\n"));
  process.exit();
});
```

## ğŸ¤¦ğŸ»â€â™€ï¸ ì‹œí–‰ì°©ì˜¤

### ìµœëŒ€ ê°’ê³¼ ìµœì†Œ ê°’ì„ ê°ê° ì–´ë–»ê²Œ ê´€ë¦¬í• ê¹Œ

ì²˜ìŒì—ëŠ” í•˜ë‚˜ì˜ ìš°ì„ ìˆœìœ„ íë¡œ ìµœëŒ€ê°’ê³¼ ìµœì†Œê°’ì„ ì œê±°í•´ë‚˜ê°€ë©´ì„œ ìµœì¢…ì ì¸ ë‹µì„ ì°¾ìœ¼ë ¤ê³  í–ˆëŠ”ë° ë„ì €íˆ ìƒê°ì´ ë‚˜ì§€ ì•Šì•˜ë‹¤. ê·¸ë˜ì„œ ê²€ìƒ‰í•´ë³´ë‹ˆ ìµœëŒ€/ìµœì†Œí™ì„ ê°ì êµ¬ì„±í•˜ê³  ë”°ë¡œ ê°ì²´ ìƒì„±í•´ì„œ ì œê±°ëœ ê°’ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì°¾ì•˜ë‹¤.

> ğŸ ì°¸ê³ 
>
> [[ë°±ì¤€] ì´ì¤‘ ìš°ì„ ìˆœìœ„ í(7662)](https://ryulurala.tistory.com/m/345)

### ë©”ëª¨ë¦¬ ì´ˆê³¼ê°€ ê³„ì† ë°œìƒí•œë‹¤ë©´ ëª¨ë“ˆ í™•ì¸í•˜ê¸°

3ê°œì›” ì „ì— ì‹¤íŒ¨í•˜ê³  3ì£¼ ì „ì—ë„ ì‹¤íŒ¨í•˜ë©° ì˜¤ëŠ˜ì€ ê¼­ í•´ê²°í•´ì•¼ê² ë‹¤ ìƒê°í•˜ë©° ë°˜ë‚˜ì ˆì„ ë‹¤ ë³´ëƒˆë‹¤. ê³„ì† **ë©”ëª¨ë¦¬ ì´ˆê³¼**ê°€ ë°œìƒí–ˆê³  ì›ì¸ì„ ì°¾ìœ¼ë ¤ê³  í•œ ì¤„ì”© ì£¼ì„ì¹˜ë©´ì„œ ì°¾ì•˜ì§€ë§Œ ê²°êµ­ ì°¾ì§€ ëª»í–ˆê³  ë‹¤ë¥¸ ë¶„ì˜ ì½”ë“œë¥¼ ë³´ë©´ì„œ fs ëª¨ë“ˆì´ ì•„ë‹Œ **readline ëª¨ë“ˆì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤**ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.

ê°€ë” ë°±ì¤€ ë¬¸ì œë¥¼ í’€ ë•Œ ëª¨ë“ˆ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ì‹œê°„ì„ ë§ì´ ì†Œìš”í•˜ë©´ í˜ì´ ë¹ ì§ˆ ë•Œë„ ìˆì§€ë§Œ.. ìì£¼ ì•ˆí’€ì–´ì„œ ê¹Œë¨¹ì—ˆë˜ ë‚´ íƒ“ì´ë‹ˆê¹Œ..
