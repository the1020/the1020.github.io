---
title: Reactì˜ Ref
author: ì˜ˆì€
date: 2022-07-29 19:56:00 +0900
categories: [study]
tags: [React]
---

RefëŠ” DOM ë…¸ë“œë‚˜ ë¦¬ì•¡íŠ¸ ì—˜ë¦¬ë¨¼íŠ¸ì— ì ‘ê·¼í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤. HTML ìš”ì†Œì— í¬ì»¤ìŠ¤ë¥¼ ì£¼ê±°ë‚˜ ì• ë‹ˆë©”ì´ì…˜ ìˆ˜í–‰ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤. Ref ì „ë‹¬í•˜ê¸°ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ refë¥¼ ìì‹ ì˜ refë¡œì„œ ì™¸ë¶€ì— ë…¸ì¶œì‹œí‚¤ê²Œ í•©ë‹ˆë‹¤.

## useRefì™€ forwardRef

```javascript
//ğŸ“„ Login.js
const Login = () => {
  const emailRef = useRef();
  const passwordRef = useRef();

  return (
    <>
      <Input type="email" ref={emailRef} />
      <Input type="password" ref={passwordRef} />
    </>
  );

  //ğŸ“„ Input.js
  const Input = React.forwardRef((props, ref) => {
    return <input type={props.type} ref={ref}>
  });
};
```

ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì¸ `Login` ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„ ì–¸í•œ refë¥¼ ìì‹ ì»´í¬ë„ŒíŠ¸ì¸ `Input` ì»´í¬ë„ŒíŠ¸ë¡œ ê°ê° ì „ë‹¬í•œë‹¤. `Input` ì»´í¬ë„ŒíŠ¸ì—ì„œ `React.forwardRef`ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•˜ì˜€ê³  `React.forwardRef`ëŠ” propsì™€ ref íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ React ë…¸ë“œë¥¼ ë°˜í™˜í•˜ëŠ” ë Œë”ë§ í•¨ìˆ˜ë¥¼ ë°›ëŠ”ë‹¤. ì´ëŸ° ë°©ë²•ìœ¼ë¡œ `Input`ì„ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì€ input DOM ë…¸ë“œì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê³ , í•„ìš”í•œ ê²½ìš° DOM inputì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

> âš ï¸ ë‘ ë²ˆì§¸ ref ì¸ìëŠ” React.forwardRefì™€ ê°™ì´ í˜¸ì¶œëœ ì»´í¬ë„ŒíŠ¸ë¥¼ ì •ì˜í–ˆì„ ë•Œì—ë§Œ ìƒì„±ë©ë‹ˆë‹¤. ì¼ë°˜ í•¨ìˆ˜ë‚˜ í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ëŠ” ref ì¸ìë¥¼ ë°›ì§€ë„ ì•Šê³  propsì—ì„œ ì‚¬ìš©í•  ìˆ˜ë„ ì—†ìŠµë‹ˆë‹¤.

## useImperativeHandle

`Login`ì—ì„œ `Input`ì˜ refì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” `useImperativeHandle`ì„ ì‚¬ìš©í•œë‹¤.
ìœ„ `Login` ì»´í¬ë„ŒíŠ¸ì— ë²„íŠ¼ 2ê°œ(`focusEmail`, `focusPassword`)ì™€ ê° ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ Inputì— focusë¥¼ ì£¼ëŠ” í•¨ìˆ˜(`loginInputFocusHandler`, `passwordInputFocusHandler`)ë¥¼ ì¶”ê°€í•˜ì˜€ë‹¤.

```javascript
//ğŸ“„ Login.js
const Login = () => {
  const emailRef = useRef();
  const passwordRef = useRef();

  const loginInputFocusHandler = () => {
    emailRef.current.focus();
  }

  const passwordInputFocusHandler = () => {
    passwordRef.current.focus();
  }

  return (
    <>
      <Input type="email" ref={emailRef} />
      <Input type="password" ref={passwordRef} />
      <button id="focusEmail" onClick={loginInputFocusHandler}>Email Focus</button>
      <button id="focusPassword" onClick={passwordInputFocusHandler}>Password Focus</button>
    </>
  );

  //ğŸ“„ Input.js
  const Input = React.forwardRef((props, ref) => {
    const inputRef = useRef();

    const activate = () => {
        inputRef.current.focus();
    };

    useImperativeHandle(ref, () => {
        return { focus: activate };
    });

    return <input type={props.type} ref={inputRef}>
  });
};
```

ì´ë©”ì¼ Inputì˜ í¬ì»¤ìŠ¤ë¥¼ ìœ„í•œ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ `emailRef.current.focus();`ê°€ ì‹¤í–‰ë˜ê³  ì´ ë•Œ `focus()`ëŠ” Inputì—ì„œ `useImperativeHandle` ë‚´ì—ì„œ ë°˜í™˜ëœ ê°ì²´ì˜ focusë¼ëŠ” ìš”ì†Œì˜ í•¨ìˆ˜ì´ë‹¤. focusëŠ” activateë¼ëŠ” í•¨ìˆ˜ë¥¼ ë‹´ê³  ìˆê¸° ë•Œë¬¸ì— ìµœì¢…ì ìœ¼ë¡œ activate()ê°€ ì‹¤í–‰ëœë‹¤.

ì¦‰, `focusEmail` ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ Inputì˜ activateê°€ ì‹¤í–‰ë˜ë©° input DOM ìš”ì†Œì— í¬ì»¤ìŠ¤ê°€ ì¡íŒë‹¤.

## ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ ì‹¤ì œ ì‚¬ìš©í•œ forwardRefì™€ useImperativeHandle ì•Œì•„ë³´ê¸°

[Tockler](https://github.com/MayGo/tockler)ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì´ìš© ì‹œê°„ì„ ì¶”ì í•˜ëŠ” ì„œë¹„ìŠ¤ë¡œ ì¼ë ‰íŠ¸ë¡ ê³¼ ë¦¬ì•¡íŠ¸, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ ê°œë°œë˜ì—ˆë‹¤.

ë©”ì¸ í™”ë©´ ìƒë‹¨ì—ëŠ” ê¸°ê°„ì„ ì„ íƒí•˜ê³  ê·¸ ê¸°ê°„ë§Œí¼ì˜ ì´ìš© ì‹œê°„ì„ ì°¨íŠ¸ë¡œ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤. DataRangeInputì—ì„œ ê¸°ê°„ì„ ì„ íƒí•˜ëŠ” input ìš”ì†Œì˜ ê°’ì´ ë³€ê²½ë˜ë©´ datepickerì˜ ì„ íƒëœ ë‚ ì§œ ê°’ë„ ë³€ê²½í•˜ëŠ” ë‚´ìš©ì´ë‹¤.

ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ëŠ” datePicker ì»´í¬ë„ŒíŠ¸ì˜ ì†ŒìŠ¤ë¥¼ ì‚´í´ë³´ë©´ refë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.
(ì‹¤ì œ í”„ë¡œê·¸ë¨ì—ì„œëŠ” input ìš”ì†Œì˜ ê°’ì„ ì„ì˜ë¡œ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤. ë‚˜ì¤‘ì— ì†ŒìŠ¤ ë¶„ì„ì„ í•˜ê²Œ ë˜ë©´ ìì„¸íˆ ì•Œì•„ë´ì•¼ê² ë‹¤.)

![tockler-datepicker](/assets/img/post/react/ref/tockler-datepicker.png)

> ì•„ë˜ ì½”ë“œëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•ì€ ìƒëµí•˜ê³  í•´ë‹¹ ë‚´ìš©ì„ ì„¤ëª…í•˜ê¸° ìœ„í•œ ì½”ë“œë§Œì„ ê°€ì ¸ì˜¨ ê²ƒì´ë‹¤. ì‹¤ì œ ì½”ë“œëŠ” ì•„ë˜ ê¹ƒí—™ ë§í¬ë¥¼ ì°¸ê³ í•˜ë©´ ëœë‹¤.
>
> - ğŸ“„ [DatePicker.tsx](https://github.com/MayGo/tockler/blob/master/client/src/components/Datepicker/Datepicker.tsx)
> - ğŸ“„ [DateRangeInput.tsx](https://github.com/MayGo/tockler/blob/master/client/src/components/Datepicker/DateRangeInput.tsx)

```javascript
// ğŸ“„ DatePicker.tsx
export const DatePicker = React.forwardRef((props, ref) => {
  /* ... */
  // ğŸ‘‡ DatePickerë¥¼ í˜¸ì¶œí•œ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ refë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ onDateSelectë¼ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.
  useImperativeHandler(ref, () => ({
    onDateSelect: (date) => {
      dp.onDateSelect(date);
    },
  }));
  /* ... */
});

// ğŸ“„ DateRangeInput.tsx
export const DateRangeInput = (props) => {
  const datePickerRef = useRef();

  function handleInputChange(date) {
    if (
      datePickerRef &&
      datePickerRef.current &&
      datePickerRef.current.onDataSelect
    ) {
      // ğŸ‘‡ onDateSelectëŠ” DatePickerì˜ useImperativeHandlerì—ì„œ ë…¸ì¶œì‹œí‚¨ í•¨ìˆ˜ì´ë‹¤.
      datepickerRef.current.onDateSelect(date);
    }
  }

  return (
    /* ... */
    <Input onChange={handleInputChange} /* ... */ />
    <DatePicker ref={datePickerRef} /* ... */ />
    /* ... */
  )
};
```

`DatePicker`ëŠ” ì™¸ë¶€ì—ì„œ refë¥¼ ì „ë‹¬ë°›ê³  `useImperativeHandler`ì—ì„œ ì™¸ë¶€ì—ì„œ refì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” `onDateSelect`ë¼ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.
ê·¸ë¦¬ê³  `DateRangeInput`ëŠ” `DatePicker`ì— datePickerRefë¼ëŠ” refë¥¼ ì „ë‹¬í•˜ê³  Inputì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬(`handleInputChange`)ì—ì„œ ì´ refë¥¼ í†µí•´ì„œ DatePickerì˜ dpë¼ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì˜ ìš”ì†Œë¥¼ í˜¸ì¶œí•œë‹¤.
